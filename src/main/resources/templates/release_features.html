<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring3-3.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorator="layout/template">

<body>
	<section layout:fragment="content">

		<div class="title-container">
			<ol class="breadcrumb breadcrumb-arrow">
				<li><a href="/">Home</a></li>
				<li class="active"><span>Features</span></li>
				<li></li>
			</ol>
			<div class="analisy-mode right">
				<div class="filter-buttons">
					<div class="dropdown">
						<button class="btn btn-primary dropdown-button">
							Feature configuration: All<i class="fas fa-chevron-down"></i>
						</button>
						<div id="myDropdown" class="dropdown-content">
							<i class="fas fa-search"></i> <input type="text"
								placeholder="Search.." id="myInput" onkeyup="filterFunction()">
							<a href="#" class="prod-config">All</a> <a
								th:each="product : ${products}" href="#" class="prod-config"
								th:text="${product.productId}"></a>
						</div>
					</div>
				</div>
			</div>
		</div>


		<hr />
		<div id="tp"></div>
		<script th:inline="javascript">

				
				var xScale = d3.scale.linear()
				.domain([0, [[${maxModifiedLines}]] ])
				.range([100, 255]);
				var xScaleScattering = d3.scale.linear()
				.domain([ 1,3,5,6,7,8,9,10,11,12,14,15,100000 ])
				.range([0.4,0.6,0.8,0.8,0.9,0.9,1,1,1.2,1.2,1.4, 1.5,1.5]);
		
		
				options.treestring=[[${newickString}]];
			    options.labelcolors= /*[# th:each="feature,iter : ${features}"]*/[[${feature.name.toUpperCase()}]]+":#0000ff"+ Math.floor(xScale([[${feature.linesAdded}]])).toString(16)/*[# th:unless="${iter.last}"]*/+","+ /*[/]*//*[/]*/; 
			    options.labelscales= /*[# th:each="feature,iter : ${features}"]*/[[${feature.name.toUpperCase()}]]+":"+ Math.round(xScaleScattering([[${feature.featureScattering}]]) * 100) / 100/*[# th:unless="${iter.last}"]*/+","+ /*[/]*//*[/]*/; 


      
      		    $(function(){

      		        $(".filter-menu").on('click', 'li a', function(){
      		          $(this).parents('.dropdown').find('.dropdown-toggle').html($(this).text()+"<span class='caret'></span>");
      		          $(this).parents('.dropdown').find('.dropdown-toggle').attr('data-id',$(this).attr('data-id'));
      		          $(this).parents('.dropdown').find('.dropdown-toggle').val($(this).text()+"<span class='caret'></span>");
      		          
      		       	$.ajax({
      		       		type: 'POST',
      		       		url : "/features/filtered",
      		       		accept: "application/json",
      		       		data: JSON.stringify({ productReleaseId :$("#product-list").find('.dropdown-toggle').attr("data-id"), developerId :$("#developer-list").find('.dropdown-toggle').attr("data-id")}),
      		       		datatype:"json",
      		       		contentType: "application/json",
      		       		success: function(data) {
      		            }
      		       		
      		       	});
      		        	
      		        });

      		    });

			</script>

	</section>



</body>
</html>

